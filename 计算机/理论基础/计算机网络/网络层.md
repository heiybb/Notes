一、关于网络层标准的争论：
  OSI制定的标准是参考电信网，采用面向连接（通信前双方先建立一条连接——虚电路VC，然后通信全基于这条连接上面）的可靠性传输
	
	而实际上因特网的制定者采用的设计是：网络层向上只提供简单灵活的、无连接的、尽最大努力的数据报服务，通俗点就是网络层不提供服务质量的承诺
	
二、虚拟互连网络



三、分类IP地址
	IP地址现由因特网名字与号码指派公司ICANN进行分配
	IP地址编制经历了以下三个历史阶段：
		1、分类IP地址（用{<网络号>,<主机号>}来表示）——1981
		2、子网的划分——1985
		3、构成超网——1993
	近些年使用无分类IP地址进行路由选择，传统的A类、B类、C类地址的区分已经称为历史，但早些时候进行分类是为了满足不同用户的需求，所以分类IP还是有研究意义的
	
	A：网络号占最前面一个字节，且第一位恒为0，A类地址范围为
			1.0.0.0~126.255.255.255
	B：网络号占最前面两个字节，且最前面两位恒为10，B类地址范围为
			128.0.0.0~191.255.255.255
	C：网络号占最前面三个字节，且最前面三位恒为110，C类地址范围为
			192.0.0.1~223.255.255.255
	D：这个是多播地址，开头4位是1110
	E：这个是未设置地址，保留给以后用
	
	
	特殊地址：
网络号
主机号
意思
0
0
本网络上的本主机，只允许源地址使用——使用见DHCP协议
0
x
本网络上主机号为x的主机，只允许源地址使用
全1
全1
在本网络上进行广播，只允许目的地址使用——即路由器 不转发
x
全1
对x网络上的所有主机进行广播
127
非全0或全1 的任何数
用作本地软件的环回测试
	
	一个问题：为什么B类C类要直接减掉一个网络号，既然128.0.0.0不指派，那么128.0.0.1应该可以啊
	
	IP地址的特点：
		1、按分等级的<网络号><主机号>进行分层，这样可以由分配到网络号的组织自行组件自己的网络
		2、路由根据网络号转发分组，减少路由表大小，减少查找时间
		3、IP地址实际上是绑定链路接口的，当一台主机同时隶属于多个网络，就称为多归属主机
		4、一个网络中所有主机的网络号必须相同，不同网络必须通过路由器相连
		5、所有分配到网络号的网络都是平等的（不受范围大小等影响）
		
	对于仅由连线构成的网络，一般不分配IP地址，这种网络称为无名网络或无编号网络
	
	
四、地址解析协议ARP（知道IP地址找到物理地址）
	逆地址解析协议RARP已经被包含在DHCP协议中了，所以不再使用RARP
	
	ARP协议的过程
		1、每个主机（当然也包括路由器）内部都有一个 ARP高速缓存，里面记录的是本局域网（问题：树状集线器组成的网络是一个网络，但是是一个局域网吗？还是只有带叶子结点的分支叫局域网？）上各主机和路由器的IP/物理地址映射表
		2、刚开始加电时缓存是空（显然嘛——缓存）
		3、以主机A为例，它想发给主机B一段信息，如果缓存中有B硬件地址，直接发就行
		4、如果检查后发现没有，就自动向本局域网群发ARP，其中带有的信息包括A的IP地址和MAC地址，以及要找的B的IP地址
		5、群发不是B的自然收了就丢掉，B则收下ARP并通过单播方式（问题：这里是怎么单播的，又到PPP和CSMA/CD的斗争了？而且总线形式，非A主机不拦下怎么知道是传给谁的？）传给A，注意：若此时B的缓存中没有A的地址，就会把A的记在自己的缓存中
		6、A收到后记下B的信息到缓存，然后开始发信息
		
	注意：
		1、ARP每一项缓存都有时间限定（10~20分钟），超过这个时间自动删除（没办法，位置不够嘛）
		2、ARP只解决同一局域网上的地址解析问题，非同一局域网的解析不了，实际上也不用解析——封装的MAC帧的源地址和目的地址只反映当前阶段的，即会不断变化，所以只需要解析出本局域网出口的路由器MAC就可以了
		
	使用IP而不使用MAC地址作为标识的原因
		各种网络的硬件结构不同，如果为了能让它们通信，就必须进行复杂的硬件地址转换，而这个不应该由主机来完成——应该由接入网络的链路接口来完成，所以就抽象IP地址层来解决

	IP数据报格式
		4位版本：指IP协议版本号，4指IPv4
		4位首部长度：指首部有多少个4字节，即首部必须为4字节整数倍
		8位区间服务：只有在使用区间服务DS的时候使用此字段
		16位总长度：指最大传送单元MTU
		
		16位标识：
		3位标志：最低位为MF，MF=1表示后面还有分片，MF=0表示最后一片；中间位为DF，DF=0表示不能分片，DF=1表示能；最高位没意义
		13位片偏移：表示当前片在原帧中偏移多少个8字节，则分片必须为8字节整数倍
		
		8位生存时间TTL：指数据报在网络中的寿命，原先用秒做时间单位，现在改为“跳数限制”，每次发送到其它结点前都减1，小于0就丢弃
		8位协议：指上层协议，一般有以下几种
ICMP
IGMP
TCP
EGP
IGP
UDP
IPv6
OSPF
1
2
6
8
9
17
41
89
		16位首部检验和：用于检验数据报首部的字段，其值为将首部分为16位序列后进行反码和计算的值；验证方式即接收端将首部分为16位序列后进行反码和计算，为0则正确，非0则错误
		
		32位源地址
		
		32位目的地址
		
		可变字段：为了丰富IP数据报的功能加上的字段，至于加什么根据设置进行，但加完后一定用0补充为4字节的整数倍，这个在IPv6中没有了，所以不讨论细节
		
五、IP层转发分组的流程
	每个主机中都有一个路由表，表只含两列——目的主机所在的网络和下一条地址
	
	特定主机路由
	默认路由
	
	1、从数据报首部提取目的主机IP地址D，得出目的网络地址为N
	2、若N就是当前网络，直接交付
	3、若N不是当前网络，就查看路由表的，按特定主机路由、目的主机所在网络、默认路由的顺序查找，优先查找到哪个就传到对应下一跳地址
	4、如果都查不到，就报告转发分组出错
	
六、划分子网
	划分子网前分类IP的缺点
		1、IP地址空间的利用率有时很低
		2、给每一个物理网络分配一个网络号会使路由表变得很大因而使网络性能变坏
		3、两级IP不够灵活
		
	为了划分子网，加入子网掩码的概念，那么一台主机所在的网络号就变为IP地址和子网掩码的与值
	
	老标准规定子网号不能全1或者全0，但采用误分类网络号后可以使用，但还是不用的好
	
七、构造超网（无分类编址CIDR，也称路由聚合）
	IETF在变长子网掩码VLSM（1987年的RFC1009已经提出）的基础上演变出无分类编址方法，正式名为无分类域间路由选择CIDR，在1993年形成RFC1517~1520文档
	
	CIDR有以下特点：
		1、消除传统A\B\C类地址和子网划分的概念，改为{<网络前缀>,<主机号>}的IP编址方式，引入斜线记法，也称为CIDR记法：
			IP地址/前缀位数
		2、引入CIDR地址块，即知道一个主机IP地址的CIDR记法，就可以知道当前块的地址范围（实际上也是分类地址，只是更灵活了），当然主机号全0和全1还是一般不用
		
	由于以前使用划分子网，为了减小改动，依旧使用子网掩码（但标准是称为地址掩码）来表示划分——前缀位全为1，后面全为0得到的值就是子网掩码的值
	
	最长前缀匹配
		当进行查找路由表（与子网掩码进行与操作与目标网络进行匹配，超网中记录的是前缀位数）时可能会匹配多个项，这时候就必须选择最长前缀匹配，显然，匹配的最长前缀网络一定是说有匹配成功网络的子网络
		
		采用二叉线索查找路由表，同时引入压缩技术加快查询
	
	关于超网和子网的区别
		注意在路由表构建上的区别
		
		
八、网际控制报文协议ICMP


九、路由选择协议
	理想算法的特点
		1、算法必须是正确的和完整的
		2、算法在计算上应简单
		3、算法应能适应通信量和网络拓扑的变化
		4、算法应该具有稳健性
		5、算法应该是公平的
		6、算法应该是最佳的
	静态路由选择策略（非自适应路由选择）
	
	动态路由选择策略（自适应路由选择）
